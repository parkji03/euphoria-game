var MOB={gumballMachines:null,gummyBears:null,createGummyBear:function(e,l,t,a,i,o,r,n){var c=i.create(l,t,a);c.scale.setTo(WORLD.scale),e.physics.arcade.enable(c),c.body.collisionWorldBounds=!0,c.body.bounce.set(1),c.body.gravity.set(0,-1e3),c.anchor.setTo(.5);var u=Math.floor(2*Math.random());c.rotationDirection=1==u?1:-1,c.rotationLimit=12,1==Math.floor(2*Math.random())?(c.moveDirection=1,c.scale.x*=-1):c.moveDirection=-1,c.initMoveSpeed=100,c.moveSpeed=100,c.isMoving=o,o||c.body.bounce.set(0),"left"===r?c.scale.setTo(WORLD.scale):"right"===r&&c.scale.setTo(-WORLD.scale,WORLD.scale),n&&(c.bullets=this.createGummyBearBullets(e,a))},createGummyBearBullets:function(e,l){var t=e.add.group();return t.enableBody=!0,t.physicsBodyType=Phaser.Physics.ARCADE,"red_gummy_bear"===l?t.createMultiple(50,"red_gumball"):"green_gummy_bear"===l?t.createMultiple(50,"green_gumball"):"yellow_gummy_bear"===l?t.createMultiple(50,"yellow_gumball"):"orange_gummy_bear"===l?t.createMultiple(50,"orange_gumball"):"blue_gummy_bear"===l&&t.createMultiple(50,"blue_gumball"),t.setAll("checkWorldBounds",!0),t.setAll("outOfBoundsKill",!0),t.setAll("body.allowGravity",!1),t},updateGummyBearMovement:function(e){e.physics.arcade.collide(this.gummyBears,WORLD.worldLayer),e.physics.arcade.overlap(PLAYER.sprite,this.gummyBears,function(){PLAYER.death(e)},null,e),this.gummyBears.forEach(function(l){e.physics.arcade.collide(l,WORLD.clouds,function(e,l){e.body.touching.down&&(e.body.position.x=e.body.position.x+l.deltaX,e.body.position.y=e.body.position.y+l.deltaY)});l.isMoving&&(l.angle>l.rotationLimit?l.rotationDirection=-1:l.angle<-l.rotationLimit&&(l.rotationDirection=1),l.angle+=.5*l.rotationDirection,e.physics.arcade.collide(MOB.gummyBears,WORLD.mobBlockLayer)&&(l.moveDirection*=-1,l.scale.x*=-1),l.moveSpeed=l.initMoveSpeed+100*(1-UI.happyBarPercent),console.log(l.moveSpeed),l.body.velocity.x=l.moveDirection*l.moveSpeed)},e)},createGumballMachine:function(e,l,t,a,i){var o=a.create(l,t,"gumball_machine");return o.triggered=!1,o.anchor.setTo(.5),o.initSpeed=8,o.shootDirection=i,"left"===i?o.scale.setTo(1.45):o.scale.setTo(-1.45,1.45),e.physics.arcade.enable(o),o.animations.add("shoot",[0,1,1,2,2,3,0,0,0],4,!0).speed=o.initSpeed,o.initFireRate=3e3,o.initBulletSpeed=200,o.fireRate=3e3,o.nextFire=0,o.bulletSpeed=200,o.bullets=this.createGumballMachineBullets(e),o},createGumballMachineBullets:function(e){var l=e.add.group();l.enableBody=!0,l.physicsBodyType=Phaser.Physics.ARCADE;for(var t=0;t<20;t++){var a=getRandomInt(1,3);1===a?(l.createMultiple(1,"red_gumball"),l.createMultiple(1,"blue_gumball"),l.createMultiple(1,"yellow_gumball")):2===a?(l.createMultiple(1,"blue_gumball"),l.createMultiple(1,"orange_gumball"),l.createMultiple(1,"green_gumball")):3===a&&(l.createMultiple(1,"yellow_gumball"),l.createMultiple(1,"red_gumball"),l.createMultiple(1,"blue_gumball"))}return l.setAll("checkWorldBounds",!0),l.setAll("outOfBoundsKill",!0),l.setAll("body.allowGravity",!1),l},updateGumballMachineMovement:function(e){e.physics.arcade.collide(this.gumballMachines,WORLD.worldLayer),MOB.gumballMachines.forEach(function(l){if(l.triggered&&(l.animations.play("shoot").speed=l.initSpeed+10*(1-UI.happyBarPercent),l.bulletSpeed=l.initBulletSpeed+70*(1-UI.happyBarPercent),l.fireRate=l.initFireRate-1700*(1-UI.happyBarPercent),e.time.now>l.nextFire&&l.bullets.countDead()>0)){l.nextFire=e.time.now+l.fireRate;var t=l.bullets.getFirstDead();"left"===l.shootDirection?(t.reset(l.position.x-13,l.position.y+10),t.body.velocity.x=-1*l.bulletSpeed):(t.reset(l.position.x+10,l.position.y+10),t.body.velocity.x=l.bulletSpeed)}e.physics.arcade.collide(l.bullets,WORLD.worldLayer,function(e){e.kill()}),e.physics.arcade.overlap(PLAYER.sprite,l.bullets,function(l,t){PLAYER.alive&&t.kill(),PLAYER.death(e)},null,e)},e)},create:function(){},update:function(e){this.updateGumballMachineMovement(e),this.updateGummyBearMovement(e)}};